"""
"""


from typing import List
from collections import deque


class Solution:
    def shortestDistance(self, grid: List[List[int]]) -> int:
        dirs = [[1,0 ], [-1, 0], [0, 1], [0, -1]]
        rows = len(grid)
        cols = len(grid[0])
        total = [[0] * cols for _ in range(rows)]

        emptyLandValue = 0
        minDist = float('inf')

        for row in range(rows):
            for col in range(cols):

                if grid[row][col] == 1:
                    minDist = float('inf')
                    q = deque([(row, col)])

                    steps = 0

                    while q:

                        steps += 1

                        for level in range(len(q), 0, -1):
                            curr = q.popleft()

                            for dir in dirs:

                                nextRow = curr[0] + dir[0]
                                nextCol = curr[1] + dir[1]

                                if 0 <= nextRow < rows and 0 <= nextCol < cols and grid[nextRow][nextCol] == emptyLandValue:
                                    grid[nextRow][nextCol] -= 1
                                    total[nextRow][nextCol] += steps
                                    q.append((nextRow, nextCol))
                                    minDist = min(minDist, total[nextRow][nextCol])

                    emptyLandValue -= 1

        return -1 if minDist == float('inf') else minDist


# Output: 7
grid = [
    [1,0,2,0,1],
    [0,0,0,0,0],
    [0,0,1,0,0]
]
# grid = [[1,0]]  # 1
# grid = [[1]]  # -1
# 7220
grid = [
    [0,0,1,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,1,0,0,0,0,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,2,0,0,0,2,1,0,0,0,1,0,0,0,2,1,1,0,0,0,0,0,0,0,0,2],
    [0,0,0,0,0,1,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,0,2,0,0,2,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,2,1,1,0],[0,0,0,1,0,0,0,1,0,0,2,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,1,1,0,0,0,0,0,2,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,2,0,1,1,0,0,0,0,2,0,1,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,2,2,0,0,0,2,1,1,0],[0,0,0,0,0,1,1,0,0,2,0,2,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,1,0,1,0,1,0,0,2,0,2,0,0,0],[0,2,0,0,1,1,0,0,2,0,0,0,1,2,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,2,0,0,0,1,0,0,1,1,0,2,0,0,0,0,1,1,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,1,0,1,2,0,0,0,0,2,0,1,0,0,1,0,1,2,0,0,2,0,0,0,0,0,2,1,0],[0,0,0,0,0,2,0,0,2,0,1,0,2,2,2,0,0,0,1,2,0,2,0,0,0,0,0,0,0,0,0,1,0,2,2,0,2,0,0,0,0,2,0,0,0,1,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,2,0,0,0,0,0,0,0,2,0,2,2,0,0,0,0,0,0,2,0,0,2,1,0,0,0,2,0,0,0,0,0,0,2,0],[0,1,0,0,0,2,2,0,2,2,0,0,0,0,0,0,2,0,0,0,0,0,1,0,0,0,2,0,1,0,1,1,0,0,0,2,0,2,0,0,0,0,0,1,0,0,0,2,0,1],[0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,0,0,0,1,0,1,2,0,1,0,0,0,2,0,0,0,0,0,1,2,1,1,1,1,0,0,0,0,0,2,0,2,0,2,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,1,2,0,0,1,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,1,0,0,2],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,2,2,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,0,0],[0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,2,1,0,2,0,0,1,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,0,1,0,0,0,0,0,0,0,0,2,0],[0,2,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,2,2,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0],[2,1,1,0,0,1,0,0,0,0,0,0,0,2,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,2,1,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[2,0,1,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,2,2,2,0,0,1,0,2,1,0,0,2,2,2,0,0,0,2,0,0,0,0,0,0,0],[0,2,2,2,0,2,0,0,1,0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,0,2,2,1,2,0,0,0,2,1,0,0,0,0,0,0,2,0,0,2,1,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0],[2,0,0,1,1,1,0,0,0,0,0,0,0,0,0,2,1,0,0,2,0,0,0,0,0,1,0,2,0,0,0,1,0,0,0,0,2,1,0,0,0,0,0,0,0,1,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,1],[0,0,2,1,0,0,1,0,0,2,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0],[1,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,1,0,2,1,0,1,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0],[0,0,0,1,0,0,0,2,0,0,0,1,0,0,1,0,1,0,0,1,2,2,0,0,0,0,0,0,0,0,0,2,0,2,0,0,1,1,0,0,0,2,0,0,0,0,2,0,1,0],[1,0,1,0,0,0,0,2,2,0,0,0,1,2,1,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,1,2,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0],[2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0],[0,0,2,0,0,0,1,0,0,0,0,1,2,0,0,0,0,0,2,0,2,0,0,1,0,0,0,0,2,0,0,0,1,0,0,0,2,2,0,0,2,0,1,0,1,0,0,2,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0],[0,2,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,2,0,1,0,0,0,0,0,0,1,0,0,0,0,0,2,0,0,0,1,0,0,2,0,0,0,0],[1,0,1,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0],[0,0,2,0,2,1,2,0,0,0,0,0,0,0,0,2,2,0,1,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,0],[0,2,0,1,0,0,0,0,0,2,0,0,2,1,0,0,2,0,0,1,0,0,0,0,0,0,1,0,0,0,1,2,0,0,0,0,2,0,2,1,0,0,0,0,1,0,2,0,0,0],[0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,1,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,2,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,2,0,0,0,1,0,0,1],[2,0,0,0,2,0,0,0,0,1,0,0,0,0,0,2,2,0,0,0,2,2,0,2,2,0,0,0,0,0,0,1,0,1,0,2,0,0,2,0,0,0,1,0,0,0,1,0,2,0],[1,2,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,2,0,0],[0,0,0,0,0,1,1,0,2,0,0,2,0,0,0,0,0,2,1,0,0,0,0,0,0,0,1,0,0,0,0,1,2,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,0,0]]
print(Solution().shortestDistance(grid))

